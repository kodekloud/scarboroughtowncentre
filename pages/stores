<div class="container-fluid" style="margin-top:60px">
    <div class="row">
        <div class="col-md-4 text-center">
            <img class="side_img" src="http://placehold.it/300x650" />
        </div>
        <div class="col-md-8 page_div">
            <h1>Stores</h1>
            <div class="line"></div>
            <p class="mini_nav"><a class="active" href="#">STORE LIST</a><a href="#">CENTRE MAP</a><a href="#">NEW STORES</a><a href="#">PROMOTIONS</a></p>
            <p class="mini_nav_2"><a class="active" href="#alphabetical" aria-controls="alphabetical" role="tab" data-toggle="tab">ALPHABETICAL</a><a href="#categories" aria-controls="categories" role="tab" data-toggle="tab">CATEGORY</a></p>
             <div class="tab-content">
                <div role="tabpanel" class="tab-pane active" id="alphabetical">
                    <p class="alpha_list">
                        <a href="#a">A</a>
                        <a href="#b">B</a>
                        <a href="#c">C</a>
                        <a href="#d">D</a>
                        <a href="#e">E</a>
                        <a href="#f">F</a>
                        <a href="#g">G</a>
                        <a href="#h">H</a>
                        <a href="#i">I</a>
                        <a href="#j">J</a>
                        <a href="#k">K</a>
                        <a href="#l">L</a>
                        <a href="#m">M</a>
                        <a href="#n">N</a>
                        <a href="#o">O</a>
                        <a href="#p">P</a>
                        <a href="#q">Q</a>
                        <a href="#r">R</a>
                        <a href="#s">S</a>
                        <a href="#t">T</a>
                        <a href="#u">U</a>
                        <a href="#v">V</a>
                        <a href="#w">W</a>
                        <a href="#x">X</a>
                        <a href="#y">Y</a>
                        <a href="#z">Z</a>
                    </p>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="store_list" id="store_list_container">
                                <script id="store_list_template" type="x-tmpl-mustache/text">
                                    <div class="store_list_content">
                                        <p class="store_initial" style="{{show}}">{{initial}}</p>
                                        <p class="store_name"><a href="/stores/{{slug}}">{{name}}</a></p>
                                    </div>
                                </script>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="store_list" id="store_list_container_right">
                                <script id="store_list_template_right" type="x-tmpl-mustache/text">
                                    <div class="store_list_content">
                                        <p class="store_initial" style="{{show}}">{{initial}}</p>
                                        <p class="store_name"><a href="/stores/{{slug}}">{{name}}</a></p>
                                    </div>
                                </script>
                            </div>
                        </div>
                    </div>
                </div>
                <div role="tabpanel" class="tab-pane" id="categories">.safsd..</div>
            </div>
        </div>
    </div>
</div>
<script>
    $(document).ready(function() {
        $('a[data-toggle="tab"]').on('shown.bs.tab', function (e) {
            $('.mini_nav_2 a').removeClass('active')
            $(this).addClass('active')
        })
        function renderAll (){
            var stores = getStoresList();
            renderPageData('#store_list_container','#store_list_template', stores, "stores", "A", "M");
            renderPageData('#store_list_container_right','#store_list_template_right', stores, "stores", "M", "Z");
        }
        
        function renderPageData(container, template, collection, type,starter, breaker){
            var item_list = [];
            var item_rendered = [];
            var template_html = $(template).html();
            Mustache.parse(template_html);   // optional, speeds up future uses
            var store_initial=""
            $.each( collection , function( key, val ) {
                if (type == "stores" || type == "category_stores"){
                    if(!val.store_front_url ||  val.store_front_url.indexOf('missing.png') > -1 || val.store_front_url.length === 0){
                        val.alt_store_front_url = "http://kodekloud.s3.amazonaws.com/sites/54cfab316e6f6433ad020000/77c900d783abeb362232339ece231335/10dundas_default.jpg"    
                    } else {
                        val.alt_store_front_url = getImageURL(val.store_front_url);    
                    }
                    
                }
                //var categories = getStoreCategories();
                var current_initial = val.name[0];
                
                if(store_initial == current_initial){
                    val.initial = "";
                    val.show = "display:none;"
                }
                else{
                    val.initial = current_initial;
                    store_initial = current_initial;
                    val.show = "display:block;"
                }
                if (val.promotions.length > 0){
                    val.promotion_exist = "display:inline-block"
                }
                else{
                    val.promotion_exist = "display:none"
                }
                if (val.jobs.length > 0){
                    val.job_exist = "display:inline-block"
                }
                else{
                    val.job_exist = "display:none"
                }
                val.block = current_initial + '-block';
                var rendered = Mustache.render(template_html,val);
                var upper_current_initial = current_initial.toUpperCase();
                if (upper_current_initial.charCodeAt(0) < breaker.charCodeAt(0) && upper_current_initial.charCodeAt(0) >= starter.charCodeAt(0)){
                    item_rendered.push(rendered);
                }
    
            });
            
            $(container).show();
            $(container).html(item_rendered.join(''));
        };  
        loadMallData(renderAll); 
    })
</script>